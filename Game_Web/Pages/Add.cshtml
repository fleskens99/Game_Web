@page
@model AddModel
@{
    ViewData["Title"] = "Add Game";
}

<link rel="stylesheet" href="~/css/Add_Game.css" />

<div class="add-game-page">
  <div class="header">
    <div>
      <div class="title">Add a new game</div>
      <div class="subtitle">Enter the details below and upload an image.</div>
    </div>
  </div>

  <form class="add-game-form" method="post" enctype="multipart/form-data">
    <div>
      <div asp-validation-summary="ModelOnly" class="hint"></div>

      <div class="form-group">
        <label asp-for="Game.Name">Name</label>
        <input asp-for="Game.Name" id="nameInput" />
        <span asp-validation-for="Game.Name" class="hint"></span>
      </div>

      <div class="form-group">
        <label asp-for="Game.Description">Description</label>
        <textarea asp-for="Game.Description" rows="2" class="auto-resize" id="descriptionInput"></textarea>
        <span asp-validation-for="Game.Description" class="hint"></span>
      </div>

      <div class="form-group">
        <label asp-for="Game.Categorie">Category</label>
        <input asp-for="Game.Categorie" id="categoryInput" />
        <span asp-validation-for="Game.Categorie" class="hint"></span>
      </div>

      <div class="form-group">
        <label for="Picture">Picture</label>
        <div class="file-input">
          <label class="btn btn-ghost" style="cursor:pointer;">
            Choose file
            <input asp-for="Picture" id="fileInput" type="file" accept="image/*" />
          </label>
          <div class="hint">@Model.SelectedFileName ?? "No file selected"</div>
        </div>
        <span asp-validation-for="Picture" class="hint"></span>
      </div>

      <div class="controls" style="margin-top:1rem;">
        <button type="submit" class="btn btn-primary">Save Game</button>
        <a asp-page="/Index" class="btn btn-ghost" role="button">Cancel</a>
      </div>
    </div>

    <div class="side-card">
      <div style="display:flex; align-items:center; justify-content:flex-end; gap:.6rem; margin-bottom:.5rem;">
        <button asp-page-handler="Preview" type="submit" id="showPreviewBtn" class="btn btn-primary">Show Preview</button>
      </div>

      @if (Model.ShowPreview)
      {
          <div id="previewContainer" class="preview-container" aria-hidden="false">
            <div class="preview">
              <img id="previewImg" src="@(Model.PreviewImagePath ?? Url.Content("~/images/placeholder.png"))" alt="preview" />
              <div>
                <div class="badge">Preview</div>
                <div class="hr"></div>
                <div class="row">
                  <div class="title" style="font-size:1rem">@Model.Game?.Name</div>
                  <div class="hint">@Model.Game?.Categorie</div>
                </div>
                <div style="margin-top:.5rem;">
                  <div class="hint">@Model.Game?.Description</div>
                </div>
              </div>
            </div>
          </div>
      }
      else
      {
          <div style="margin-top:.75rem;">
            <div class="hint">Press "Show Preview" to render a server-side preview.</div>
          </div>
      }
    </div>
  </form>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
